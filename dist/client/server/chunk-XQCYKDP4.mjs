import './polyfills.server.mjs';
import{a as A}from"./chunk-4LVRNOTK.mjs";import{B as D,E as T,F as m,G as B,H as V,I as q,J as G,K as X,P as $,Q as R,R as z,e as k,f as w,g as L,h as N}from"./chunk-VE4EHLCX.mjs";import{$a as i,Aa as j,Ga as I,La as _,R as M,W as g,X as f,Za as a,_a as n,ab as P,ca as v,eb as y,hb as x,ib as u,qb as o,rb as C,sb as E,ub as F,va as c,vb as O}from"./chunk-MBAFEM7P.mjs";import"./chunk-X2SEQXRR.mjs";function J(t,e){t&1&&(n(0,"div",4),o(1," Cargando proyectos... "),i())}function H(t,e){if(t&1&&(n(0,"div",5),o(1),i()),t&2){let r=u();c(),E(" ",r.error()," ")}}function K(t,e){t&1&&(n(0,"div"),o(1," El campo es requerido "),i())}function Q(t,e){t&1&&(n(0,"div",18),o(1," El campo no puede estar vacio "),i())}function W(t,e){t&1&&(n(0,"div",18),o(1," M\xE1ximo 20 caract\xE9res "),i())}function Y(t,e){t&1&&(n(0,"div"),o(1," El campo es requerido "),i())}function Z(t,e){t&1&&(n(0,"div",18),o(1," El campo no puede estar vacio "),i())}function ee(t,e){t&1&&(n(0,"div",18),o(1," M\xE1ximo 90 caract\xE9res "),i())}function te(t,e){if(t&1){let r=y();n(0,"div",19)(1,"h3"),o(2),i(),n(3,"p"),o(4),i(),n(5,"small"),o(6),F(7,"date"),i(),n(8,"div",20)(9,"button",21),x("click",function(){let d=g(r).$implicit,p=u(2);return f(p.delete(d.id))}),o(10,"Eliminar"),i(),n(11,"button",21),x("click",function(){let d=g(r).$implicit,p=u(2);return f(p.editProject(d.id))}),o(12," Editar "),i()()()}if(t&2){let r=e.$implicit;c(2),C(r.name),c(2),C(r.description),c(2),E("Creado el: ",O(7,3,r.createdAt))}}function re(t,e){t&1&&(n(0,"div",22),o(1," No tienes proyectos creados a\xFAn. "),i())}function ie(t,e){if(t&1){let r=y();n(0,"div",6)(1,"h2"),o(2,"Mis Proyectos"),i(),n(3,"div",7)(4,"form",8),x("ngSubmit",function(){g(r);let d=u();return f(d.onSubmit())}),n(5,"div",9)(6,"label",10),o(7,"Nombre"),i(),P(8,"input",11),_(9,K,2,0,"div",12)(10,Q,2,0,"div",13)(11,W,2,0,"div",13),i(),n(12,"div",9)(13,"label",10),o(14,"Descrpci\xF3n"),i(),P(15,"textarea",14),_(16,Y,2,0,"div",12)(17,Z,2,0,"div",13)(18,ee,2,0,"div",13),i(),n(19,"button",15),o(20,"Crear"),i()()(),_(21,te,13,5,"div",16)(22,re,2,0,"div",17),i()}if(t&2){let r,s,d,p,h,b,S,l=u();c(4),a("formGroup",l.projectForm),c(5),a("ngIf",((r=l.projectForm.get("name"))==null||r.errors==null?null:r.errors.required)&&((r=l.projectForm.get("name"))==null?null:r.touched)),c(),a("ngIf",(s=l.projectForm.get("name"))==null||s.errors==null?null:s.errors.minlength),c(),a("ngIf",(d=l.projectForm.get("name"))==null||d.errors==null?null:d.errors.maxlength),c(5),a("ngIf",((p=l.projectForm.get("description"))==null||p.errors==null?null:p.errors.required)&&((p=l.projectForm.get("description"))==null?null:p.touched)),c(),a("ngIf",(h=l.projectForm.get("description"))==null||h.errors==null?null:h.errors.minlength),c(),a("ngIf",(b=l.projectForm.get("description"))==null||b.errors==null?null:b.errors.maxlength),c(3),a("ngForOf",l.projects()),c(),a("ngIf",((S=l.projects())==null?null:S.length)===0)}}var U=class t{constructor(e,r,s){this.projectService=e;this.router=r;this.fb=s;this.projectForm=this.fb.group({name:["",[m.required,m.minLength(1),m.maxLength(20)]],description:["",[m.required,m.minLength(1),m.maxLength(90)]],admin_id:["",m.required]})}projectForm;userData;projects=v(null);isLoading=v(!1);error=v(null);snackBar=M(z);ngOnInit(){this.getProjects(),this.loadUser(),this.userData&&this.projectForm.patchValue({admin_id:this.userData.id})}loadUser(){let e=localStorage.getItem("user");if(e)try{this.userData=JSON.parse(e)}catch{this.snackBar.open("Error al obtener datos del usuario","X",{duration:3e3}),this.userData=null}}getProjects(){this.isLoading.set(!0),this.error.set(null),this.projectService.getProjects().subscribe({next:e=>{this.projects.set(e),console.log(this.projects()),this.isLoading.set(!1)},error:e=>{this.error.set("Error al cargar proyectos"),this.isLoading.set(!1),this.snackBar.open(`Error al recuperar proyectos: ${e}`,"X",{duration:3e3})}})}onSubmit(){this.projectForm.valid&&(this.isLoading.set(!0),this.error.set(null),this.projectService.createProject(this.projectForm.value).subscribe({next:e=>{this.snackBar.open("Proyecto creado","X",{duration:3e3}),this.getProjects(),this.isLoading.set(!1)},error:e=>{this.error.set("Error al crear proyectos"),this.isLoading.set(!1),this.snackBar.open(`Error al crear proyectos: ${e}`,"X",{duration:3e3})}}))}editProject(e){this.router.navigate(["/dashboard/edit_project",e])}delete(e){confirm("\xBFEst\xE1s seguro de eliminar el proyecto?")&&(this.isLoading.set(!0),this.error.set(null),this.projectService.deleteProject(e).subscribe({next:()=>{this.snackBar.open("Proyecto eliminado","X",{duration:3e3}),this.getProjects()},error:r=>{this.error.set(`Error: ${r.message}`),this.snackBar.open("Error al eliminar proyecto","X",{duration:3e3})},complete:()=>{this.isLoading.set(!1)}}))}static \u0275fac=function(r){return new(r||t)(j(A),j(D),j($))};static \u0275cmp=I({type:t,selectors:[["app-projects"]],decls:4,vars:3,consts:[[1,"projects-container"],["class","loading-spinner",4,"ngIf"],["class","error-message",4,"ngIf"],["class","project-list__container",4,"ngIf"],[1,"loading-spinner"],[1,"error-message"],[1,"project-list__container"],[1,"create-project__container"],[1,"create-project__form",3,"ngSubmit","formGroup"],[1,"form-control"],["for",""],["type","text","formControlName","name"],[4,"ngIf"],["class","error",4,"ngIf"],["name","description","formControlName","description"],["type","submit",1,"btn-create-project"],["class","project-card",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"error"],[1,"project-card"],[1,"projects-btns__container"],[1,"project-btn",3,"click"],[1,"empty-state"]],template:function(r,s){r&1&&(n(0,"section",0),_(1,J,2,0,"div",1)(2,H,2,1,"div",2)(3,ie,23,9,"div",3),i()),r&2&&(c(),a("ngIf",s.isLoading()),c(),a("ngIf",s.error()),c(),a("ngIf",s.projects()&&!s.isLoading()))},dependencies:[N,k,w,R,q,T,B,V,G,X,L],styles:[".projects-container[_ngcontent-%COMP%]{padding:2rem}.loading-spinner[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#666}.error-message[_ngcontent-%COMP%]{color:#d32f2f;padding:1rem;background-color:#fde0e0;border-radius:4px}.project-list__container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;align-items:center}.project-list__container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem}.project-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:1.5rem;margin-bottom:1rem;box-shadow:0 2px 4px #0000001a;display:flex;flex-direction:column;margin:auto;width:80%}.project-card[_ngcontent-%COMP%]:hover{transform:scale(1.1);transition:.5s;cursor:pointer}.empty-state[_ngcontent-%COMP%]{text-align:center;color:red;padding:2rem}.create-project__container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.create-project__form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;box-shadow:0 0 5px #333;border-radius:7px;padding:30px}.form-control[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px;font-size:1.4rem}.btn-create-project[_ngcontent-%COMP%]{border:0;box-shadow:0 0 5px #333;background-color:#02c980;color:#fff;font-weight:600;font-size:1.2rem;cursor:pointer}.projects-btns__container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;margin-top:10px}.projects-btns__container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block}.project-btn[_ngcontent-%COMP%]{border:none;color:#fff;border-radius:7px;box-shadow:0 0 5px #333;background-color:#02c980;width:100px;height:40px;font-size:1.2rem;font-weight:600;display:flex;justify-content:center;align-items:center;display:block;cursor:pointer}.project-btn[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:inherit}.project-btn[_ngcontent-%COMP%]:first-child{background-color:#dc3545}.project-btn[_ngcontent-%COMP%]:nth-child(2){background-color:#0d6efd}.error[_ngcontent-%COMP%]{color:red}"]})};export{U as Projects};
