import './polyfills.server.mjs';
import{a as E,b as r,c as M,d as N,e as S,f as y,g as F,h as O,i as P,j as A,l as U,m as k}from"./chunk-NPBPRQSE.mjs";import{B as _,E as w,I as L,f as b,h as x,y as C}from"./chunk-FRORQDJ3.mjs";import{$a as t,Aa as s,Ga as h,La as f,R as g,Za as p,_a as i,ab as l,ca as d,hb as v,qb as o,va as c}from"./chunk-AKJV5UCE.mjs";import"./chunk-X2SEQXRR.mjs";function I(m,e){m&1&&(i(0,"div"),o(1," Email no v\xE1lido. "),t())}var B=class m{constructor(e,n,a,u){this.fb=e;this.authService=n;this.route=a;this.router=u;this.id=Number(this.route.snapshot.paramMap.get("id")),this.userForm=this.fb.group({name:["",[r.required,r.minLength(1),r.maxLength(50)]],lastName:["",[r.required,r.minLength(1),r.maxLength(50)]],email:["",[r.required,r.email]],role:["user",[r.required]]})}userForm;id;user=d(null);snackBar=g(w);isLoading=d(!1);error=d(null);ngOnInit(){this.getUser()}getUser(){this.isLoading.set(!0),this.error.set(null),this.authService.getUserById(this.id).subscribe({next:e=>{this.user.set(e),this.userForm.patchValue({name:this.user()?.name,lastName:this.user()?.lastName,email:this.user()?.email,role:this.user()?.role}),this.isLoading.set(!1)},error:e=>{this.error.set("Error obteniendo el usuario"),this.isLoading.set(!1),this.showError("Error obteniendo el usuario: "+e.message)}})}onSubmit(){if(this.userForm.invalid){this.userForm.markAllAsTouched(),this.snackBar.open("Por favor complete el formulario correctamente","X",{duration:3e3});return}this.isLoading.set(!0),this.error.set(null),this.authService.updateUser(this.id,this.userForm.value).subscribe({next:e=>{this.snackBar.open("Usuario actualizado correctamente","X",{duration:3e3}),this.router.navigate(["/dashboard/users"])},error:e=>{this.error.set("Error al actualizar usuario"),this.snackBar.open(`Error al actualizar usuario: ${e.message}`,"X",{duration:3e3})},complete:()=>{this.isLoading.set(!1)}})}showError(e){this.snackBar.open(e,"Cerrar",{duration:3e3,panelClass:["error-snackbar"]})}static \u0275fac=function(n){return new(n||m)(s(U),s(L),s(C),s(_))};static \u0275cmp=h({type:m,selectors:[["app-edit-user"]],decls:26,vars:3,consts:[[1,"login-form__container"],[1,"login-form",3,"ngSubmit","formGroup"],["src","planning.png","alt","Task-Manager",1,"logo"],["type","text","formControlName","name"],["type","text","formControlName","lastName"],["type","email","formControlName","email"],[4,"ngIf"],["formControlName","role"],["value","user"],["value","admin"],["type","submit",1,"update-user-btn",3,"disabled"]],template:function(n,a){if(n&1&&(i(0,"div",0)(1,"form",1),v("ngSubmit",function(){return a.onSubmit()}),l(2,"img",2),i(3,"div")(4,"label"),o(5,"Nombres"),t(),l(6,"input",3),t(),i(7,"div")(8,"label"),o(9,"Apellidos"),t(),l(10,"input",4),t(),i(11,"div")(12,"label"),o(13,"Email"),t(),l(14,"input",5),f(15,I,2,0,"div",6),t(),i(16,"div")(17,"label"),o(18,"Role"),t(),i(19,"select",7)(20,"option",8),o(21,"Usuario"),t(),i(22,"option",9),o(23,"Administrador"),t()()(),i(24,"button",10),o(25,"Actualizar"),t()()()),n&2){let u;c(),p("formGroup",a.userForm),c(14),p("ngIf",(u=a.userForm.get("email"))==null?null:u.hasError("email")),c(9),p("disabled",!a.userForm.valid)}},dependencies:[x,b,k,S,P,A,E,O,M,N,y,F],styles:[".login-form__container[_ngcontent-%COMP%]{width:100%;height:100vh;display:flex;justify-content:center;align-items:center}.login-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:30px;border-radius:7px;box-shadow:0 0 5px #333;width:400px;height:auto;padding:5px}.login-form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.login-form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;height:40px}.login-form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:1.3rem;width:90%}.login-form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:90%}.logo[_ngcontent-%COMP%]{width:150px;height:150px;margin-top:20px}.update-user-btn[_ngcontent-%COMP%]{background-color:#2e46ba;color:#fff;border-radius:7px;border:0;box-shadow:0 0 5px #333;font-size:1.4rem;cursor:pointer}.update-user-btn[_ngcontent-%COMP%]:hover{background-color:#1d2f8a}"]})};export{B as EditUser};
