import './polyfills.server.mjs';
import{B as U,E as N,F as o,G as k,H as y,I as F,J as I,K as L,L as D,M as q,N as A,O as V,P as B,Q as T,R as G,V as R,e as E,f as P,h as w}from"./chunk-MFEC3RBD.mjs";import{$a as e,Aa as g,Ga as M,La as v,R as C,W as h,X as _,Za as m,_a as t,ab as c,ca as p,eb as O,hb as f,ib as b,qb as r,rb as u,sb as S,va as a}from"./chunk-AKJV5UCE.mjs";import"./chunk-X2SEQXRR.mjs";function z(s,n){s&1&&(t(0,"div",24),r(1," Cargando usuarios... "),e())}function j(s,n){if(s&1&&(t(0,"div",25),r(1),e()),s&2){let i=b();a(),S(" ",i.error()," ")}}function J(s,n){if(s&1){let i=O();t(0,"tr")(1,"td"),r(2),e(),t(3,"td"),r(4),e(),t(5,"td"),r(6),e(),t(7,"td"),r(8),e(),t(9,"td"),r(10),e(),t(11,"td",26)(12,"button",27),f("click",function(){let d=h(i).$implicit,x=b();return _(x.editUser(d.id))}),r(13,"Editar"),e(),t(14,"button",28),f("click",function(){let d=h(i).$implicit,x=b();return _(x.deleteUser(d.id))}),r(15,"Eliminar"),e()()()}if(s&2){let i=n.$implicit;a(2),u(i.id),a(2),u(i.name),a(2),u(i.lastName),a(2),u(i.email),a(2),u(i.role||"user")}}function X(s,n){s&1&&(t(0,"tr")(1,"td",29),r(2,"No hay usuarios registrados"),e()())}var $=class s{constructor(n,i,l){this.authService=n;this.fb=i;this.router=l;this.userForm=this.fb.group({name:["",[o.required,o.minLength(1),o.maxLength(50)]],lastName:["",[o.required,o.minLength(1),o.maxLength(50)]],email:["",[o.required,o.email]],password:["",[o.required,o.minLength(1),o.maxLength(12)]],role:["user",[o.required]]})}userForm;users=p([]);isLoading=p(!1);error=p(null);userData;snackBar=C(G);newUser={name:"",lastName:"",email:"",password:"",role:"user"};ngOnInit(){this.loadUser(),this.loadUsers()}loadUser(){let n=localStorage.getItem("user");if(n)try{this.userData=JSON.parse(n)}catch{this.snackBar.open("Error al obtener datos del usuario","X",{duration:3e3}),this.userData=null}}loadUsers(){this.isLoading.set(!0),this.error.set(null),this.authService.listUsers().subscribe({next:n=>{this.users.set(n),this.isLoading.set(!1)},error:n=>{this.error.set("Error al cargar usuarios"),this.isLoading.set(!1),this.showError(`Error al cargar usuarios: ${n.message}`)}})}onSubmit(){this.userForm.valid&&(this.isLoading.set(!0),this.error.set(null),this.authService.register(this.userForm.value).subscribe({next:n=>{this.showSuccess("Usuario creado"),this.loadUsers()},error:n=>{this.showError(`Error al eliminar usuario: ${n.message}`),this.error.set(n.message||"Error durante el registro")},complete:()=>{this.isLoading.set(!1)}}))}editUser(n){this.router.navigate(["/dashboard/edit_users",n])}deleteUser(n){confirm("\xBFEst\xE1 seguro de eliminar este usuario?")&&(this.isLoading.set(!0),this.authService.deleteUser(n).subscribe({next:()=>{this.showSuccess("Usuario eliminado correctamente"),this.loadUsers()},error:i=>{this.showError(`Error al eliminar usuario: ${i.message}`),this.isLoading.set(!1)}}))}resetForm(){this.newUser={name:"",lastName:"",email:"",password:"",role:"user"}}showError(n){this.snackBar.open(n,"Cerrar",{duration:3e3,panelClass:["error-snackbar"]})}showSuccess(n){this.snackBar.open(n,"Cerrar",{duration:3e3,panelClass:["success-snackbar"]})}static \u0275fac=function(i){return new(i||s)(g(R),g(B),g(U))};static \u0275cmp=M({type:s,selectors:[["app-users"]],decls:57,vars:5,consts:[[1,"users-container"],[1,"user-form-container"],[1,"user-form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","name"],["type","text","id","name","name","name","required","","formControlName","name"],["for","lastName"],["type","text","id","lastName","name","lastName","required","","formControlName","lastName"],["for","email"],["type","email","id","email","name","email","required","","formControlName","email"],["for","password"],["type","password","id","password","name","password","required","","formControlName","password"],["for","role"],["id","role","name","role","formControlName","role"],["value","user"],["value","admin"],["type","submit",1,"btn-submit"],[1,"table-section"],["class","loading-spinner",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"table-responsive"],[1,"users-table"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"loading-spinner"],[1,"error-message"],[1,"actions"],[1,"btn-edit",3,"click"],[1,"btn-delete",3,"click"],["colspan","6",1,"text-center"]],template:function(i,l){if(i&1&&(t(0,"div",0)(1,"h2"),r(2,"Lista de Usuarios"),e(),t(3,"div",1)(4,"h3"),r(5,"Agregar Nuevo Usuario"),e(),t(6,"form",2),f("ngSubmit",function(){return l.onSubmit()}),t(7,"div",3)(8,"label",4),r(9,"Nombres"),e(),c(10,"input",5),e(),t(11,"div",3)(12,"label",6),r(13,"Apellidos"),e(),c(14,"input",7),e(),t(15,"div",3)(16,"label",8),r(17,"Email"),e(),c(18,"input",9),e(),t(19,"div",3)(20,"label",10),r(21,"Contrase\xF1a"),e(),c(22,"input",11),e(),t(23,"div",3)(24,"label",12),r(25,"Rol"),e(),t(26,"select",13)(27,"option",14),r(28,"Usuario"),e(),t(29,"option",15),r(30,"Administrador"),e()()(),t(31,"button",16),r(32,"Guardar Usuario"),e()()(),t(33,"div",17)(34,"h3"),r(35,"Lista de Usuarios"),e(),v(36,z,2,0,"div",18)(37,j,2,1,"div",19),t(38,"div",20)(39,"table",21)(40,"thead")(41,"tr")(42,"th"),r(43,"ID"),e(),t(44,"th"),r(45,"Nombres"),e(),t(46,"th"),r(47,"Apellidos"),e(),t(48,"th"),r(49,"Email"),e(),t(50,"th"),r(51,"Rol"),e(),t(52,"th"),r(53,"Acciones"),e()()(),t(54,"tbody"),v(55,J,16,5,"tr",22)(56,X,3,0,"tr",23),e()()()()()),i&2){let d;a(6),m("formGroup",l.userForm),a(30),m("ngIf",l.isLoading()),a(),m("ngIf",l.error()),a(18),m("ngForOf",l.users()),a(),m("ngIf",((d=l.users())==null?null:d.length)===0&&!l.isLoading())}},dependencies:[w,E,P,T,F,q,A,N,D,k,y,V,I,L],styles:[".users-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.user-form-container[_ngcontent-%COMP%]{background-color:#f8f9fa;padding:20px;border-radius:8px;box-shadow:0 0 10px #0000001a;margin-bottom:30px}.user-form-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;color:#343a40;border-bottom:1px solid #dee2e6;padding-bottom:10px}.user-form[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:500;color:#495057}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #ced4da;border-radius:4px;font-size:.9rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#80bdff;box-shadow:0 0 0 .2rem #007bff40}.btn-submit[_ngcontent-%COMP%]{grid-column:1 / -1;background-color:#28a745;color:#fff;border:none;padding:10px 15px;border-radius:4px;cursor:pointer;font-size:.9rem;transition:background-color .3s}.btn-submit[_ngcontent-%COMP%]:hover{background-color:#218838}@media (max-width: 768px){.user-form[_ngcontent-%COMP%]{grid-template-columns:1fr}}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto;box-shadow:0 0 10px #0000001a;border-radius:8px;margin-top:20px}.users-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.9rem}.users-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .users-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;text-align:left;border-bottom:1px solid #ddd}.users-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;font-weight:600;color:#495057}.users-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.actions[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-edit[_ngcontent-%COMP%]{background-color:#17a2b8;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;transition:background-color .3s}.btn-edit[_ngcontent-%COMP%]:hover{background-color:#138496}.btn-delete[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;transition:background-color .3s}.btn-delete[_ngcontent-%COMP%]:hover{background-color:#c82333}@media (max-width: 768px){.users-table[_ngcontent-%COMP%]{font-size:.8rem}.users-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .users-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 10px}.actions[_ngcontent-%COMP%]{flex-direction:column;gap:4px}.btn-edit[_ngcontent-%COMP%], .btn-delete[_ngcontent-%COMP%]{padding:4px 8px;font-size:.7rem}}"]})};export{$ as Users};
