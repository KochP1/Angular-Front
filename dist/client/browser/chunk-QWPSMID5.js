import{a as A}from"./chunk-XVVF6W2W.js";import{C as X,D as R,E as z,a as O,b as w,c as L,d as N,o as T,r as D,s as m,t as V,u as B,v as q,w as $,x as G}from"./chunk-RHEHRKPS.js";import{$a as y,Da as I,Ia as f,R as M,Ua as s,Va as n,W as _,Wa as i,X as g,Xa as P,ca as j,cb as v,db as u,lb as o,mb as C,nb as E,rb as k,sa as c,sb as F,xa as x}from"./chunk-UFSGMEGV.js";import"./chunk-6MDQTQU3.js";function J(t,e){t&1&&(n(0,"div",4),o(1," Cargando proyectos... "),i())}function H(t,e){if(t&1&&(n(0,"div",5),o(1),i()),t&2){let r=u();c(),E(" ",r.error()," ")}}function K(t,e){t&1&&(n(0,"div"),o(1," El campo es requerido "),i())}function Q(t,e){t&1&&(n(0,"div",18),o(1," El campo no puede estar vacio "),i())}function W(t,e){t&1&&(n(0,"div",18),o(1," M\xE1ximo 20 caract\xE9res "),i())}function Y(t,e){t&1&&(n(0,"div"),o(1," El campo es requerido "),i())}function Z(t,e){t&1&&(n(0,"div",18),o(1," El campo no puede estar vacio "),i())}function ee(t,e){t&1&&(n(0,"div",18),o(1," M\xE1ximo 90 caract\xE9res "),i())}function te(t,e){if(t&1){let r=y();n(0,"div",19),v("click",function(){let l=_(r).$implicit,d=u(2);return g(d.onClick(l.id))}),n(1,"h3"),o(2),i(),n(3,"p"),o(4),i(),n(5,"small"),o(6),k(7,"date"),i(),n(8,"div",20)(9,"button",21),v("click",function(){let l=_(r).$implicit,d=u(2);return g(d.delete(l.id))}),o(10,"Eliminar"),i(),n(11,"button",21),v("click",function(){let l=_(r).$implicit,d=u(2);return g(d.editProject(l.id))}),o(12," Editar "),i()()()}if(t&2){let r=e.$implicit;c(2),C(r.name),c(2),C(r.description),c(2),E("Creado el: ",F(7,3,r.createdAt))}}function re(t,e){t&1&&(n(0,"div",22),o(1," No tienes proyectos creados a\xFAn. "),i())}function ie(t,e){if(t&1){let r=y();n(0,"div",6)(1,"h2"),o(2,"Mis Proyectos"),i(),n(3,"div",7)(4,"form",8),v("ngSubmit",function(){_(r);let l=u();return g(l.onSubmit())}),n(5,"div",9)(6,"label",10),o(7,"Nombre"),i(),P(8,"input",11),f(9,K,2,0,"div",12)(10,Q,2,0,"div",13)(11,W,2,0,"div",13),i(),n(12,"div",9)(13,"label",10),o(14,"Descrpci\xF3n"),i(),P(15,"textarea",14),f(16,Y,2,0,"div",12)(17,Z,2,0,"div",13)(18,ee,2,0,"div",13),i(),n(19,"button",15),o(20,"Crear"),i()()(),f(21,te,13,5,"div",16)(22,re,2,0,"div",17),i()}if(t&2){let r,a,l,d,h,b,S,p=u();c(4),s("formGroup",p.projectForm),c(5),s("ngIf",((r=p.projectForm.get("name"))==null||r.errors==null?null:r.errors.required)&&((r=p.projectForm.get("name"))==null?null:r.touched)),c(),s("ngIf",(a=p.projectForm.get("name"))==null||a.errors==null?null:a.errors.minlength),c(),s("ngIf",(l=p.projectForm.get("name"))==null||l.errors==null?null:l.errors.maxlength),c(5),s("ngIf",((d=p.projectForm.get("description"))==null||d.errors==null?null:d.errors.required)&&((d=p.projectForm.get("description"))==null?null:d.touched)),c(),s("ngIf",(h=p.projectForm.get("description"))==null||h.errors==null?null:h.errors.minlength),c(),s("ngIf",(b=p.projectForm.get("description"))==null||b.errors==null?null:b.errors.maxlength),c(3),s("ngForOf",p.projects()),c(),s("ngIf",((S=p.projects())==null?null:S.length)===0)}}var U=class t{constructor(e,r,a){this.projectService=e;this.router=r;this.fb=a;this.projectForm=this.fb.group({name:["",[m.required,m.minLength(1),m.maxLength(20)]],description:["",[m.required,m.minLength(1),m.maxLength(90)]],admin_id:["",m.required]})}projectForm;userData;projects=j(null);isLoading=j(!1);error=j(null);snackBar=M(z);ngOnInit(){this.getProjects(),this.loadUser(),this.userData&&this.projectForm.patchValue({admin_id:this.userData.id})}loadUser(){let e=localStorage.getItem("user");if(e)try{this.userData=JSON.parse(e)}catch{this.snackBar.open("Error al obtener datos del usuario","X",{duration:3e3}),this.userData=null}}getProjects(){this.isLoading.set(!0),this.error.set(null),this.projectService.getProjects().subscribe({next:e=>{this.projects.set(e),console.log(this.projects()),this.isLoading.set(!1)},error:e=>{this.error.set("Error al cargar proyectos"),this.isLoading.set(!1),this.snackBar.open(`Error al recuperar proyectos: ${e}`,"X",{duration:3e3})}})}onSubmit(){this.projectForm.valid&&(this.isLoading.set(!0),this.error.set(null),this.projectService.createProject(this.projectForm.value).subscribe({next:e=>{this.snackBar.open("Proyecto creado","X",{duration:3e3}),this.getProjects(),this.isLoading.set(!1)},error:e=>{this.error.set("Error al crear proyectos"),this.isLoading.set(!1),this.snackBar.open(`Error al crear proyectos: ${e}`,"X",{duration:3e3})}}))}onClick(e){this.router.navigate(["/dashboard/tasks",e])}editProject(e){this.router.navigate(["/dashboard/edit_project",e])}delete(e){confirm("\xBFEst\xE1s seguro de eliminar el proyecto?")&&(this.isLoading.set(!0),this.error.set(null),this.projectService.deleteProject(e).subscribe({next:()=>{this.snackBar.open("Proyecto eliminado","X",{duration:3e3}),this.getProjects()},error:r=>{this.error.set(`Error: ${r.message}`),this.snackBar.open("Error al eliminar proyecto","X",{duration:3e3})},complete:()=>{this.isLoading.set(!1)}}))}static \u0275fac=function(r){return new(r||t)(x(A),x(T),x(X))};static \u0275cmp=I({type:t,selectors:[["app-projects"]],decls:4,vars:3,consts:[[1,"projects-container"],["class","loading-spinner",4,"ngIf"],["class","error-message",4,"ngIf"],["class","project-list__container",4,"ngIf"],[1,"loading-spinner"],[1,"error-message"],[1,"project-list__container"],[1,"create-project__container"],[1,"create-project__form",3,"ngSubmit","formGroup"],[1,"form-control"],["for",""],["type","text","formControlName","name"],[4,"ngIf"],["class","error",4,"ngIf"],["name","description","formControlName","description"],["type","submit",1,"btn-create-project"],["class","project-card",3,"click",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"error"],[1,"project-card",3,"click"],[1,"projects-btns__container"],[1,"project-btn",3,"click"],[1,"empty-state"]],template:function(r,a){r&1&&(n(0,"section",0),f(1,J,2,0,"div",1)(2,H,2,1,"div",2)(3,ie,23,9,"div",3),i()),r&2&&(c(),s("ngIf",a.isLoading()),c(),s("ngIf",a.error()),c(),s("ngIf",a.projects()&&!a.isLoading()))},dependencies:[N,O,w,R,q,D,V,B,$,G,L],styles:[".projects-container[_ngcontent-%COMP%]{padding:2rem}.loading-spinner[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#666}.error-message[_ngcontent-%COMP%]{color:#d32f2f;padding:1rem;background-color:#fde0e0;border-radius:4px}.project-list__container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;align-items:center}.project-list__container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem}.project-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:1.5rem;margin-bottom:1rem;box-shadow:0 2px 4px #0000001a;display:flex;flex-direction:column;margin:auto;width:80%}.project-card[_ngcontent-%COMP%]:hover{transform:scale(1.1);transition:.5s;cursor:pointer}.empty-state[_ngcontent-%COMP%]{text-align:center;color:red;padding:2rem}.create-project__container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.create-project__form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;box-shadow:0 0 5px #333;border-radius:7px;padding:30px}.form-control[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px;font-size:1.4rem}.btn-create-project[_ngcontent-%COMP%]{border:0;box-shadow:0 0 5px #333;background-color:#02c980;color:#fff;font-weight:600;font-size:1.2rem;cursor:pointer}.projects-btns__container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;margin-top:10px}.projects-btns__container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block}.project-btn[_ngcontent-%COMP%]{border:none;color:#fff;border-radius:7px;box-shadow:0 0 5px #333;background-color:#02c980;width:100px;height:40px;font-size:1.2rem;font-weight:600;display:flex;justify-content:center;align-items:center;display:block;cursor:pointer}.project-btn[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:inherit}.project-btn[_ngcontent-%COMP%]:first-child{background-color:#dc3545}.project-btn[_ngcontent-%COMP%]:nth-child(2){background-color:#0d6efd}.error[_ngcontent-%COMP%]{color:red}"]})};export{U as Projects};
