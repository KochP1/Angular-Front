import{a as O}from"./chunk-OIYQPOTC.js";import{C as w,D as A,E as G,b as C,d as M,m as N,o as D,r as L,s as m,t as B,u as T,v as k,w as V,x as q}from"./chunk-SE2TBAJU.js";import{$a as F,Da as y,Ia as g,R as b,Ua as a,Va as i,W as P,Wa as r,X as S,Xa as h,ca as f,cb as I,db as E,lb as s,sa as l,xa as u}from"./chunk-SCZIA43R.js";import"./chunk-6MDQTQU3.js";function z(t,e){t&1&&(i(0,"div",9),s(1," El campo es requerido "),r())}function X(t,e){t&1&&(i(0,"div",9),s(1," El campo no puede estar vacio "),r())}function U(t,e){t&1&&(i(0,"div",9),s(1," M\xE1ximo 20 caract\xE9res "),r())}function $(t,e){t&1&&(i(0,"div",9),s(1," El campo es requerido "),r())}function J(t,e){t&1&&(i(0,"div",9),s(1," El campo no puede estar vacio "),r())}function H(t,e){t&1&&(i(0,"div",9),s(1," M\xE1ximo 90 caract\xE9res "),r())}function K(t,e){if(t&1){let o=F();i(0,"form",2),I("ngSubmit",function(){P(o);let d=E();return S(d.onSubmit())}),i(1,"div",3)(2,"label",4),s(3,"Nombre"),r(),h(4,"input",5),g(5,z,2,0,"div",6)(6,X,2,0,"div",6)(7,U,2,0,"div",6),r(),i(8,"div",3)(9,"label",4),s(10,"Descrpci\xF3n"),r(),h(11,"textarea",7),g(12,$,2,0,"div",6)(13,J,2,0,"div",6)(14,H,2,0,"div",6),r(),i(15,"button",8),s(16,"Actualizar"),r()()}if(t&2){let o,c,d,_,x,p,v,j,n=E();a("formGroup",n.projectEditForm),l(4),a("value",(o=n.project())==null?null:o.name),l(),a("ngIf",((c=n.projectEditForm.get("name"))==null||c.errors==null?null:c.errors.required)&&((c=n.projectEditForm.get("name"))==null?null:c.touched)),l(),a("ngIf",(d=n.projectEditForm.get("name"))==null||d.errors==null?null:d.errors.minlength),l(),a("ngIf",(_=n.projectEditForm.get("name"))==null||_.errors==null?null:_.errors.maxlength),l(4),a("value",(x=n.project())==null?null:x.description),l(),a("ngIf",((p=n.projectEditForm.get("description"))==null||p.errors==null?null:p.errors.required)&&((p=n.projectEditForm.get("description"))==null?null:p.touched)),l(),a("ngIf",(v=n.projectEditForm.get("description"))==null||v.errors==null?null:v.errors.minlength),l(),a("ngIf",(j=n.projectEditForm.get("description"))==null||j.errors==null?null:j.errors.maxlength)}}var R=class t{constructor(e,o,c,d){this.fb=e;this.route=o;this.projectService=c;this.router=d;this.projectId=Number(this.route.snapshot.paramMap.get("id")),this.projectEditForm=this.fb.group({name:["",[m.required,m.minLength(1),m.maxLength(20)]],description:["",[m.required,m.minLength(1),m.maxLength(90)]],admin_id:["",m.required]})}projectEditForm;projectId;project=f(null);userData;snackBar=b(G);isLoading=f(!1);error=f(null);ngOnInit(){this.loadUser(),this.getProject(),this.userData&&this.projectEditForm.patchValue({admin_id:this.userData.id})}loadUser(){let e=localStorage.getItem("user");if(e)try{this.userData=JSON.parse(e)}catch{this.snackBar.open("Error al obtener datos del usuario","X",{duration:3e3}),this.userData=null}}getProject(){this.isLoading.set(!0),this.error.set(null),this.projectService.getProject(this.projectId).subscribe({next:e=>{this.project.set(e),this.projectEditForm.patchValue({name:this.project()?.name}),this.projectEditForm.patchValue({description:this.project()?.description}),this.isLoading.set(!1)},error:e=>{this.error.set("Error al cargar proyectos"),this.isLoading.set(!1),this.snackBar.open(`Error al recuperar proyectos: ${e}`,"X",{duration:3e3})}})}onSubmit(){if(this.projectEditForm.invalid){this.projectEditForm.markAllAsTouched(),this.snackBar.open("Por favor complete el formulario correctamente","X",{duration:3e3});return}this.isLoading.set(!0),this.error.set(null),this.projectService.updateProject(this.projectId,this.projectEditForm.value).subscribe({next:e=>{this.snackBar.open("Proyecto actualizado correctamente","X",{duration:3e3}),this.router.navigate(["/dashboard/"])},error:e=>{this.error.set("Error al actualizar proyecto"),this.snackBar.open(`Error al actualizar proyecto: ${e.message}`,"X",{duration:3e3})},complete:()=>{this.isLoading.set(!1)}})}static \u0275fac=function(o){return new(o||t)(u(w),u(N),u(O),u(D))};static \u0275cmp=y({type:t,selectors:[["app-edit-project"]],decls:2,vars:1,consts:[[1,"create-project__container"],["class","create-project__form",3,"formGroup","ngSubmit",4,"ngIf"],[1,"create-project__form",3,"ngSubmit","formGroup"],[1,"form-control"],["for",""],["type","text","formControlName","name",3,"value"],["class","error",4,"ngIf"],["name","description","formControlName","description",3,"value"],["type","submit",1,"btn-create-project"],[1,"error"]],template:function(o,c){o&1&&(i(0,"div",0),g(1,K,17,9,"form",1),r()),o&2&&(l(),a("ngIf",c.project()&&!c.isLoading()))},dependencies:[M,C,A,k,L,B,T,V,q],styles:[".create-project__container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%}.error[_ngcontent-%COMP%]{color:red}.create-project__form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;box-shadow:0 0 5px #333;border-radius:7px;padding:30px}.form-control[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px;font-size:1.4rem}.btn-create-project[_ngcontent-%COMP%]{border:0;box-shadow:0 0 5px #333;background-color:#02c980;color:#fff;font-weight:600;font-size:1.2rem;cursor:pointer}"]})};export{R as EditProject};
